# CLI工具模块 验收标准

## 验收清单

### 功能验收

| ID | 功能点 | 验收标准 | 测试方法 |
|----|--------|---------|---------|
| AC-001 | 安装CLI工具 | 可通过 npm/npx 安装 | 手动 + 自动 |
| AC-002 | 初始化项目 | 运行 ai-dev init 成功创建项目 | 手动 + 自动 |
| AC-003 | 模板选择 | 显示4种模板供选择 | 手动 |
| AC-004 | 项目信息收集 | 收集项目名称和描述 | 手动 |
| AC-005 | 目录创建 | 在当前目录下创建项目目录 | 自动 |
| AC-006 | 基础模板复制 | .claude/ 和 CLAUDE.md 完整复制 | 自动 |
| AC-007 | 项目模板复制 | 对应项目类型的模板文件复制 | 自动 |
| AC-008 | 文档结构生成 | docs/ 目录结构正确 | 自动 |
| AC-009 | README生成 | 生成包含项目信息的 README.md | 自动 |
| AC-010 | Git初始化 | 自动执行 git init | 自动 |

### 非功能验收

| ID | 类型 | 验收标准 | 测试方法 |
|----|------|---------|---------|
| NFR-001 | 性能 | 项目创建<5秒 | 性能测试 |
| NFR-002 | 兼容性 | Node.js 14+ 正常运行 | 兼容测试 |
| NFR-003 | 易用性 | 新手5分钟内完成首次使用 | 用户测试 |
| NFR-004 | 错误处理 | 所有错误有清晰提示 | 边界测试 |

---

## 详细验收标准

### AC-001: 安装CLI工具

**Given**
- 用户已安装 Node.js 14+
- 用户有网络连接

**When**
- 用户运行 `npm install -g @ai-dev-template/cli`
- 或运行 `npx @ai-dev-template/cli init`

**Then**
- [ ] CLI 工具安装成功
- [ ] 可以运行 `ai-dev --version` 显示版本号
- [ ] 可以运行 `ai-dev --help` 显示帮助信息
- [ ] npx 方式可以直接运行不需要安装

---

### AC-002: 初始化项目

**Given**
- 用户已安装 CLI 工具
- 当前目录可写

**When**
- 用户运行 `ai-dev init`

**Then**
- [ ] 显示欢迎信息
- [ ] 显示模板选择界面
- [ ] 等待用户输入

---

### AC-003: 模板选择

**Given**
- 用户运行了 `ai-dev init`

**When**
- 系统显示模板列表

**Then**
- [ ] 显示4种模板选项：
  - Web 全栈应用
  - 移动应用
  - 后端 API 服务
  - 命令行工具
- [ ] 每个选项有清晰的描述
- [ ] 使用方向键可以选择
- [ ] 回车确认选择

---

### AC-004: 项目信息收集

**Given**
- 用户已选择模板

**When**
- 系统询问项目信息

**Then**
- [ ] 询问"项目名称"，显示默认值 "my-project"
- [ ] 项目名称格式校验（符合npm规范）
- [ ] 询问"项目描述"，显示默认值
- [ ] 允许用户直接回车使用默认值

---

### AC-005: 目录创建

**Given**
- 用户输入了项目名称 "my-awesome-project"

**When**
- 系统开始创建项目

**Then**
- [ ] 在当前目录下创建 `my-awesome-project/` 目录
- [ ] 如果目录已存在且非空，提示用户选择操作（覆盖/取消/重命名）
- [ ] 显示进度提示：`✓ 正在创建项目目录...`

---

### AC-006: 基础模板复制

**Given**
- 项目目录已创建

**When**
- 系统复制基础模板

**Then**
- [ ] `.claude/` 目录完整复制
- [ ] `.claude/skills/` 包含4个 Skill
  - requirements-analyzer/
  - architecture-designer/
  - developer-guide/
  - test-planner/
- [ ] `.claude/settings.json` 存在且格式正确
- [ ] `CLAUDE.md` 存在且内容完整
- [ ] 显示进度提示：`✓ 正在复制基础模板...`

---

### AC-007: 项目模板复制

**Given**
- 用户选择了 "Web 全栈应用" 模板

**When**
- 系统复制项目类型模板

**Then**
- [ ] 项目特定的 `.gitignore` 复制
- [ ] 项目特定的文档模板复制（如有）
- [ ] 覆盖同名的基础模板文件
- [ ] 显示进度提示：`✓ 正在复制 web-fullstack 特定配置...`

---

### AC-008: 文档结构生成

**Given**
- 模板复制完成

**When**
- 系统生成文档结构

**Then**
- [ ] 创建 `docs/` 目录
- [ ] 创建 `docs/modules/` 目录
- [ ] 创建 `docs/architecture/` 目录
- [ ] 创建 `docs/trackers/` 目录
- [ ] 所有目录权限正确（755）
- [ ] 显示进度提示：`✓ 正在创建初始文档结构...`

---

### AC-009: README生成

**Given**
- 用户输入：
  - 项目名称: "my-awesome-project"
  - 项目描述: "一个很棒的项目"
  - 项目类型: "Web 全栈应用"

**When**
- 系统生成 README.md

**Then**
- [ ] README.md 文件存在
- [ ] 包含项目名称作为标题
- [ ] 包含项目描述
- [ ] 包含项目类型信息
- [ ] 包含快速开始指南
- [ ] 包含文档结构说明
- [ ] 包含 AI 助手使用说明
- [ ] 包含 Skills 列表
- [ ] Markdown 格式正确

---

### AC-010: Git初始化

**Given**
- 项目文件已创建完成

**When**
- 系统初始化 Git

**Then**
- [ ] 执行 `git init` 命令
- [ ] `.git/` 目录存在
- [ ] `.gitignore` 文件存在
- [ ] 显示进度提示：`✓ 正在初始化 Git 仓库...`
- [ ] 不自动创建首次提交（留给用户）

---

## 边界条件测试

### BC-001: 项目名称边界

| 测试场景 | 输入 | 预期结果 |
|---------|------|---------|
| 最短名称 | `a` | ✅ 通过 |
| 最长名称 | 214个字符 | ✅ 通过 |
| 超长名称 | 215个字符 | ❌ 错误提示 |
| 包含大写 | `MyProject` | ⚠️ 警告转为小写 `myproject` |
| 包含空格 | `my project` | ❌ 错误提示 |
| 包含特殊字符 | `my@project` | ❌ 错误提示 |
| 空名称 | `` | ❌ 错误提示 |
| 纯数字 | `123` | ⚠️ 警告但允许 |

### BC-002: 目录冲突

| 测试场景 | 条件 | 预期结果 |
|---------|------|---------|
| 目录不存在 | - | ✅ 直接创建 |
| 目录存在且为空 | - | ✅ 直接使用 |
| 目录存在且非空 | - | ⚠️ 询问用户（覆盖/取消/重命名） |
| 权限不足 | 无写权限 | ❌ 错误提示 + 解决方案 |

### BC-003: 网络异常

| 测试场景 | 条件 | 预期结果 |
|---------|------|---------|
| 无网络连接 | npx 首次运行 | ❌ 错误提示 |
| 无网络连接 | 已安装全局CLI | ✅ 正常运行（使用本地模板） |
| 网络慢 | 下载超时 | ⚠️ 显示等待提示，允许取消 |

---

## 错误处理验收

### EH-001: Node.js版本不兼容

**Given**
- 用户 Node.js 版本 < 14

**When**
- 用户运行 `ai-dev init`

**Then**
- [ ] 显示红色错误提示
- [ ] 提示当前版本和要求版本
- [ ] 提供升级指引链接
- [ ] 阻止继续执行

**错误信息示例**：
```
❌ 错误: Node.js 版本过低

当前版本: v12.18.0
要求版本: >= 14.0.0

解决方案:
  1. 访问 https://nodejs.org 下载最新版本
  2. 或使用 nvm: nvm install 14

更多帮助: https://github.com/xxx/docs
```

### EH-002: 磁盘空间不足

**Given**
- 磁盘剩余空间 < 100MB

**When**
- 用户运行 `ai-dev init`

**Then**
- [ ] 检测到磁盘空间不足
- [ ] 显示红色错误提示
- [ ] 显示当前剩余空间
- [ ] 阻止继续执行

---

## 性能验收标准

### 性能基准测试

| 操作 | 性能目标 | 测试条件 | 测量结果 |
|------|---------|---------|---------|
| CLI启动 | < 100ms | 冷启动 | ⏱️ 待测 |
| 显示模板列表 | < 100ms | - | ⏱️ 待测 |
| 复制基础模板 | < 2秒 | ~50个文件 | ⏱️ 待测 |
| 完整项目创建 | < 5秒 | 从确认到成功 | ⏱️ 待测 |
| 内存占用 | < 100MB | 峰值 | 📊 待测 |

**测试工具**：
- 时间测量：`console.time()` / `console.timeEnd()`
- 内存测量：`process.memoryUsage()`

---

## 兼容性验收

### 平台兼容性

| 平台 | Node.js 14 | Node.js 16 | Node.js 18 | Node.js 20 |
|------|-----------|-----------|-----------|-----------|
| Windows 10/11 | ✅ | ✅ | ✅ | ✅ |
| macOS 11+ | ✅ | ✅ | ✅ | ✅ |
| Linux (Ubuntu 20+) | ✅ | ✅ | ✅ | ✅ |

### 终端兼容性

| 终端 | 支持情况 | 备注 |
|------|---------|------|
| Windows Terminal | ✅ 完美 | 推荐 |
| PowerShell | ✅ 完美 | |
| Git Bash | ✅ 完美 | |
| CMD | ⚠️ 基本 | 颜色可能不正确 |
| macOS Terminal | ✅ 完美 | |
| iTerm2 | ✅ 完美 | 推荐 |
| Linux Terminal | ✅ 完美 | |

---

## 用户体验验收

### UX-001: 新手完成首次使用

**Given**
- 用户是首次使用
- 用户有基本的命令行知识

**When**
- 用户按照 README 指引操作

**Then**
- [ ] 5分钟内完成项目创建
- [ ] 理解每个步骤的含义
- [ ] 知道下一步该做什么
- [ ] 无明显困惑或卡顿

### UX-002: 错误恢复

**Given**
- 用户在创建项目时遇到错误

**When**
- 系统显示错误信息

**Then**
- [ ] 错误信息清晰易懂
- [ ] 提供明确的解决方案
- [ ] 提供帮助文档链接
- [ ] 用户可以快速解决问题

---

**文档版本**: v1.0
**创建日期**: 2025-12-10
